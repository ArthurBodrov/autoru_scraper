# Скрепер объявление с сайта Auto.ru

Автоматически собирает данные об объявлениях с сайта [Auto.ru](https://auto.ru/).

Пример, как это ⬇️ объявление переходит структурированную таблицу с данными.

<img src="img/car_announcment.png">

Переходит в таблицу с данными.

| Пробег | Марка | Модель | Лошад. силы | Сегмент | Состояние | Коробка передач | Год выпуска | ... |
| :-- | :-- | :-- | :-- | :-- | :-- | :-- | :-- | :-- | 
| 259000 | VAZ | 2112 | 81 | ECONOMY | б/у | Механическая | 2007 |... |

# Как это работает

Приложение открывает страницу поиска и начинает собирать ссылки на объявления, чтобы открыть страницу с деталями и собрать подробности об автомобиле.

После сбора сбора информации обо всех автомобилях на странице, скрипт сохраняет результат в файловую систему в формате `.csv`.

# Requirements
Перечень всех зависимостей в `requirements.txt`
```
appnope==0.1.0
attrs==19.3.0
autoscraper==1.1.10
backcall==0.2.0
beautifulsoup4==4.9.3
bleach==3.1.5
...
```

# Использование

Запускать скрипт надо из терминала 
```bash
python scraper.py
```

После запуска скрипт распечает настройки и начнет собирать данные, о прогрессе будет писать в терминал. Первая нотификация о прогрессе может занять несколько минут.
![scaper work print](img/scaraper_work_print.png "scaper work print")


# Config
Скрепере настраивается через конфиг - `settings.json`.
```json
{
    "max_page": 3,
    "page_sleep_time": 2,
    "item_sleep_time": 1,
    "df_name": "autoru_items.csv"
}
```

Параметры в конфиге:
- `max_page` - максимальная страница, до который приложение будет скрепить информацию.
- `page_sleep_time` - задержка после скрепинга на странице поиска. Нужна, чтобы обойти throttling. Без задержке могут **забанить**, но сам не проверял.
- `item_sleep_time` - задержка после скрепинга на странице объявления с деталями. Нужна, чтобы обойти throttling. Без задержке могут **забанить**, но сам не проверял.
- `df_name` - настройка названия output csv файла.


# Output
Результатом скрепинга будет файл в формате `.csv`. 

![data frame example](img/data_frame_example.png "data frame example")

## Описание данных:
| Параметр | Тип | Описание    |
| :-- | :-- | :-- |
| `km_age`           | `int`    | пробег |
| `mark`     | `str`    | марка |
| `markName`     | `str`    | марка, тоже самое что `mark` |
| `model`         | `str`    | модель |
| `modelName`         | `str`    | модель, тоже самое что `modelName`  |
| `power`       | `int`   | количество лошадиных сил |
| `segment`         | `str`  | сегмент (`ECONOMY/MEDIUM/PREMIUM`) |
| `state`           | `str`  | состояние автомобиля (новый или б/у) |
| `transmission`   | `str`    | коробка передач |
| `year`     | `int`    | год выпуска |
| `engine-type`     | `str`    | тип двигателя |
| `type`         | `str`   | тип автомобиля (`suv`) |
| `region`  | `str`    | город продажи |
| `body_type`  | `str`    | тип кузова |
| `color`  | `str`    | цвет |
| `drive_type`  | `str`    | привод |
| `wheell_type`  | `str`    | тип руля (право-/леворульный) |
| `condition`  | `str`    | состояние автомобиля, необходим ли ремонт|
| `ownersCount`  | `str`    | количество владельцев |
| `is_customs`  | `str`    | растоможенность |
| `price`  | `int`    | цена автомобиля |
